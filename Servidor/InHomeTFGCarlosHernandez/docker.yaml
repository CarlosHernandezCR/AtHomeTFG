  Conversación abierta. 1 mensaje leído.
    
    Ir al contenido
    Uso de Gmail con lectores de pantalla
    14 de 1.538
  Fwd:
    Recibidos
    
    Alejandro Marino <aldamajo1@gmail.com>
    Adjuntos
    29 oct 2024, 15:48
    para mí
    
    
    
    ---------- Forwarded message ---------
  De: oscar novillo <oscar.novillo@gmail.com>
  Date: mar, 29 oct 2024 a las 12:21
  Subject:
  To: Alejandro Marino <aldamajo1@gmail.com>
    
    
    .github/workflows
    3 archivos adjuntos
    •  Analizado por Gmail
  name: Server CI workflow

  on:
    push:
      branches: [ main ]
  env:
    VERSION: 1.0

  jobs:
    # unit-tests:
    #   runs-on: self-hosted
    #   defaults:
    #     run:
    #       working-directory: ./server
    #   strategy:
    #     matrix:
    #       node-version: [16.x]
    #   steps:
    #   - uses: actions/checkout@v2
    #   - name: Use Node.js ${{ matrix.node-version }}
    #     uses: actions/setup-node@v2
    #     with:
    #       node-version: ${{ matrix.node-version }}
    #       cache: 'npm'
    #       cache-dependency-path: server/package-lock.json
    #   - run: npm ci
    #   - run: npm run unit
    deploy:
      # needs: unit-tests
      runs-on: ubuntu-latest
      steps:
        -
          name: Checkout
          uses: actions/checkout@v2
        -
          name: Set up Docker Buildx
          uses: docker/setup-buildx-action@v3
        -
          name: Login to private registry
          uses: docker/login-action@v3
          with:
            username: ${{ secrets.USERNAME_DB }}
            password: ${{ secrets.PASSWORD_DB }}
        -
          name: Build and push
          uses: docker/build-push-action@v5
          with:
            context: .
            file: ./Dockerfile
            labels: ${{ steps.meta.outputs.labels }}
            cache-from: type=gha
            cache-to: type=gha,mode=max
            #tags: ${{ steps.meta.outputs.tags }}
            builder: ${{ steps.buildx.outputs.name }}
            push: true
            tags: |
              ${{ secrets.REGISTRY_USERNAME }}/inhometfgcarloshernandez:latest
              ${{ secrets.REGISTRY_USERNAME }}/inhometfgcarloshernandez:${{ env.VERSION }}
    
